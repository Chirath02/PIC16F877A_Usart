List P= 16F877A
#include P16F877A.inc

MAIN:
CALL DISPLAY_CONFIG
CALL RECEPTION_CONFIG
BSF RCSTA,4 ;ENABLE USART RECEIVE

BANKSEL PIR1
CHECK:
	BTFSS PIR1, RCIF ; check for completion of reception
	GOTO CHECK

BANKSEL RCSTA 
MOVF RCSTA, 0 ; Get the recived byte
BANKSEL 0X20
MOVWF 0X20 ; key value stored to 0x20
CALL DISPLAY ; call DISPLAY to display the key pressed
GOTO TERMINATE

RECEPTION_CONFIG:
	BANKSEL TRISC
	MOVLW 0X83 ; RC7 as input
	MOVWF TRISC
	
	;---CONFIGURE SPBRG FOR DESIRED BAUD RATE
	MOVLW .25 ; 9600bps
	MOVWF SPBRG ; BAUD AT 4MHZ

	;---CONFIGURE TXSTA
	MOVLW B'00100100' ; CONFIGURE TXSTA AS :
	MOVWF TXSTA ;
	; 8 BIT TRANSMISSION - 6.BIT
	; TRANSMIT ENABLED - 5.BIT
	; ASYNCHRONOUS MODE - 4.BIT
	; ENABLE HIGH SPEED BAUD RATE - 2.BIT

	BANKSEL RCSTA
	MOVLW B'10000000' ; ENABLE SERIAL PORT
	MOVWF RCSTA ; RECEIVE STATUS REG
	
	RETURN

DISPLAY_CONFIG:
	BANKSEL TRISB ; PORTB AS OUTPUT FOR SEVEN SEGNMENT LED
	CLRF TRISB
	RETURN

DISPLAY: 
	; Displays the value at 0x20.
	MOVF 0X20, 0 ; Get the tranmitted keyboard value
	CALL DISPLAY_CODE ; get the corresponding value of diaplay
	MOVWF PORTC ; display the output to the 7SEG LED connected to portc
	RETURN
	
	DISPLAY_CODE:
		ADDWF PCL, 1 ; Add PCL plus the key value to display
				   ; HEX for
		RETLW 0XBF ; 0
		RETLW 0X86 ; 1
		RETLW 0XDB ; 2
		RETLW 0XCF ; 3
		RETLW 0XE6 ; 4
		RETLW 0XED ; 5
		RETLW 0XFD ; 6
		RETLW 0X87 ; 7
		RETLW 0XFF ; 8
		RETLW 0XEF ; 9
		RETLW 0XBF ; 0
		RETLW 0XEC ; S for star
		RETLW 0XF6 ; H for hash

TERMINATE:
END
