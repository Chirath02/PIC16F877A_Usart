List P= 16F877A
#include P16F877A.inc

BANKSEL TRISB
MOVLW 0X78
MOVWF TRISB
MOVLW 0XC0
MOVWF TRISC


;---CONFIGURE SPBRG FOR DESIRED BAUD RATE
	MOVLW D'51' ;WE WILL USE 4800bps 
	MOVWF SPBRG ;BAUD AT 4MHZ

	
	;---CONFIGURE TXSTA
	MOVLW B'00100100' ;CONFIGURE TXSTA AS :
	MOVWF TXSTA ;
	;8 BIT TRANSMISSION - 6.BIT
	;TRANSMIT ENABLED - 5.BIT
	;ASYNCHRONOUS MODE - 4.BIT
	;ENABLE HIGH SPEED BAUD RATE - 2.BIT

	BCF STATUS, RP0 ;SWITCH TO BANK 00
	
	MOVLW B'10000000' ;ENABLE SERIAL PORT
	MOVWF RCSTA ;RECEIVE STATUS REG

BANKSEL PORTB
CLRF PORTB


START:

MOVLW 0XFF
MOVWF 0X20

MOVLW 0X01
MOVWF PORTB
CALL SWITCH
MOVWF 0X20
BTFSS 0X20, 7
ADDLW 0X03

MOVLW 0X02
MOVWF PORTB
CALL SWITCH
MOVWF 0X20
BTFSS 0X20, 7
ADDLW 0X02

MOVLW 0X04
MOVWF PORTB
CALL SWITCH
MOVWF 0X20
BTFSS 0X20, 7
ADDLW 0X01

MOVWF 0X20

BTFSC 0X20, 7
GOTO START


BANKSEL TXSTA
MOVLW 0X30
MOVWF TXSTA

BANKSEL TXREG
MOVF 0X20, 0
MOVWF TXREG

LOOP:
	BTFSS PIR1, 4
	GOTO LOOP



GOTO START


SWITCH:
	BTFSC PORTB, 6
	RETLW 0X00
	BTFSC PORTB, 5
	RETLW 0X03
	BTFSC PORTB, 4
	RETLW 0X06
	BTFSC PORTB, 3
	RETLW 0X09
	RETLW 0XF0

TERMINATE:
END